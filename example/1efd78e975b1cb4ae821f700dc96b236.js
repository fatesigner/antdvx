var _typeof=require('@babel/runtime/helpers/typeof');require('core-js/modules/es.regexp.exec.js'),require('core-js/modules/es.string.replace.js'),require('core-js/modules/es.string.trim-end.js'),require('core-js/modules/es.string.match.js'),require('core-js/modules/es.string.trim-start.js'),require('core-js/modules/es.string.trim.js'),ace.define('ace/ext/beautify',['require','exports','module','ace/token_iterator'],(function(e,t,r){'use strict';var s=e('../token_iterator').TokenIterator;function a(e,t){return e.type.lastIndexOf(t+'.xml')>-1}t.singletonTags=['area','base','br','col','command','embed','hr','html','img','input','keygen','link','meta','param','source','track','wbr'],t.blockTags=['article','aside','blockquote','body','div','dl','fieldset','footer','form','head','header','html','nav','ol','p','script','section','style','table','tbody','tfoot','thead','ul'],t.beautify=function(e){var r,o,n,i=new s(e,0,0),u=i.getCurrentToken(),c=e.getTabString(),m=t.singletonTags,l=t.blockTags,p=!1,f=!1,d=!1,g='',h='',y='',b=0,$=0,k=0,x=0,w=0,j=0,v=0,q=0,T=0,R=!1,_=!1,O=!1,C=!1,I={0:0},B=[],F=function(){r&&r.value&&'string.regexp'!==r.type&&(r.value=r.value.replace(/^\s*/,''))},S=function(){g=g.replace(/ +$/,'')},K=function(){g=g.trimRight(),p=!1};while(null!==u){if(q=i.getCurrentTokenRow(),i.$rowTokens,r=i.stepForward(),'undefined'!==typeof u){if(h=u.value,w=0,O='style'===y||'ace/mode/css'===e.$modeId,a(u,'tag-open')?(_=!0,r&&(C=-1!==l.indexOf(r.value)),'</'===h&&(C&&!p&&T<1&&T++,O&&(T=1),w=1,C=!1)):a(u,'tag-close')?_=!1:a(u,'comment.start')?C=!0:a(u,'comment.end')&&(C=!1),_||T||'paren.rparen'!==u.type||'}'!==u.value.substr(0,1)||T++,q!==o&&(T=q,o&&(T-=o)),T){for(K();T>0;T--)g+='\n';p=!0,a(u,'comment')||u.type.match(/^(comment|string)$/)||(h=h.trimLeft())}if(h){if('keyword'===u.type&&h.match(/^(if|else|elseif|for|foreach|while|switch)$/)?(B[b]=h,F(),d=!0,h.match(/^(else|elseif)$/)&&g.match(/\}[\s]*$/)&&(K(),f=!0)):'paren.lparen'===u.type?(F(),'{'===h.substr(-1)&&(d=!0,R=!1,_||(T=1)),'{'===h.substr(0,1)&&(f=!0,'['!==g.substr(-1)&&'['===g.trimRight().substr(-1)?(K(),f=!1):')'===g.trimRight().substr(-1)?K():S())):'paren.rparen'===u.type?(w=1,'}'===h.substr(0,1)&&('case'===B[b-1]&&w++,'{'===g.trimRight().substr(-1)?K():(f=!0,O&&(T+=2))),']'===h.substr(0,1)&&'}'!==g.substr(-1)&&'}'===g.trimRight().substr(-1)&&(f=!1,x++,K()),')'===h.substr(0,1)&&'('!==g.substr(-1)&&'('===g.trimRight().substr(-1)&&(f=!1,x++,K()),S()):'keyword.operator'!==u.type&&'keyword'!==u.type||!h.match(/^(=|==|===|!=|!==|&&|\|\||and|or|xor|\+=|.=|>|>=|<|<=|=>)$/)?'punctuation.operator'===u.type&&';'===h?(K(),F(),d=!0,O&&T++):'punctuation.operator'===u.type&&h.match(/^(:|,)$/)?(K(),F(),h.match(/^(,)$/)&&v>0&&0===j?T++:(d=!0,p=!1)):'support.php_tag'!==u.type||'?>'!==h||p?a(u,'attribute-name')&&g.substr(-1).match(/^\s$/)?f=!0:a(u,'attribute-equals')?(S(),F()):a(u,'tag-close')&&(S(),'/>'===h&&(f=!0)):(K(),f=!0):(K(),F(),f=!0,d=!0),p&&(!u.type.match(/^(comment)$/)||h.substr(0,1).match(/^[/#]$/))&&(!u.type.match(/^(string)$/)||h.substr(0,1).match(/^['"]$/))){if(x=k,b>$)for(x++,n=b;n>$;n--)I[n]=x;else b<$&&(x=I[b]);for($=b,k=x,w&&(x-=w),R&&!j&&(x++,R=!1),n=0;n<x;n++)g+=c}if('keyword'===u.type&&h.match(/^(case|default)$/)&&(B[b]=h,b++),'keyword'===u.type&&h.match(/^(break)$/)&&B[b-1]&&B[b-1].match(/^(case|default)$/)&&b--,'paren.lparen'===u.type&&(j+=(h.match(/\(/g)||[]).length,v+=(h.match(/\{/g)||[]).length,b+=h.length),'keyword'===u.type&&h.match(/^(if|else|elseif|for|while)$/)?(R=!0,j=0):!j&&h.trim()&&'comment'!==u.type&&(R=!1),'paren.rparen'===u.type)for(j-=(h.match(/\)/g)||[]).length,v-=(h.match(/\}/g)||[]).length,n=0;n<h.length;n++)b--,'}'===h.substr(n,1)&&'case'===B[b]&&b--;'text'==u.type&&(h=h.replace(/\s+$/,' ')),f&&!p&&(S(),'\n'!==g.substr(-1)&&(g+=' ')),g+=h,d&&(g+=' '),p=!1,f=!1,d=!1,(a(u,'tag-close')&&(C||-1!==l.indexOf(y))||a(u,'doctype')&&'>'===h)&&(T=C&&r&&'</'===r.value?-1:1),a(u,'tag-open')&&'</'===h?b--:a(u,'tag-open')&&'<'===h&&-1===m.indexOf(r.value)?b++:a(u,'tag-name')?y=h:a(u,'tag-close')&&'/>'===h&&-1===m.indexOf(y)&&b--,o=q}}u=r}g=g.trim(),e.doc.setValue(g)},t.commands=[{name:'beautify',description:'Format selection (Beautify)',exec:function(e){t.beautify(e.session)},bindKey:'Ctrl-Shift-B'}]})),function(){ace.require(['ace/ext/beautify'],(function(e){'object'==('undefined'===typeof module?'undefined':_typeof(module))&&'object'==('undefined'===typeof exports?'undefined':_typeof(exports))&&module&&(module.exports=e)}))}();